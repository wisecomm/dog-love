
 2. CLAUDE.md에 규칙 명시                                                                                                            
                                                                                                                                      
  프로젝트 루트에 CLAUDE.md 파일을 두고 에이전트에게 규칙을 알려주는 방법입니다.                                                      
                                                                                                                                      
  # 개발 규칙                                                                                                                         
  - 코드 수정 후 반드시 `npm run build`로 컴파일 확인                                                                                 
  - `npm run lint`로 린트 통과 확인                                                                                                   
  - `npm run test`로 관련 테스트 통과 확인                                                                                            
  - 실패 시 스스로 수정하고 다시 검증할 것         

3. CI/CD 파이프라인 연동                                                                                                            
                                                                                                                                      
  GitHub Actions 등에서 에이전트가 만든 PR을 자동 검증하는 방식입니다.                                                                
                                                                                                                                      
  에이전트 코드 작성 → PR 생성 → CI가 빌드/린트/테스트 → 실패 시 에이전트가 다시 수정                                                 
                                                                                                                                      
  4. 커스텀 스크립트 래퍼                                                                                                             
                                                                                                                                      
  에이전트 실행 자체를 감싸는 스크립트를 만드는 방법입니다.                                                                           
                                                                                                                                      
  #!/bin/bash                                                                                                                         
  # verify.sh - 에이전트가 호출하는 검증 스크립트                                                                                     
  set -e                                                                                                                              
  npm run typecheck   # 타입 체크                                                                                                     
  npm run lint        # 린트                                                                                                          
  npm run test        # 테스트                                                                                                        
  echo "✅ 모든 검증 통과"                                                                                                            
                                                                                                                                      
  권장 조합                                                                                                                           
  ┌─────────────┬───────────────────┬──────────────────────────────────┐                                                              
  │    단계     │       도구        │               역할               │                                                              
  ├─────────────┼───────────────────┼──────────────────────────────────┤                                                              
  │ 즉시 피드백 │ Claude Code Hooks │ 파일 수정 시 자동 린트/타입체크  │                                                              
  ├─────────────┼───────────────────┼──────────────────────────────────┤                                                              
  │ 행동 규칙   │ CLAUDE.md         │ 에이전트에게 검증 절차 명시      │                                                              
  ├─────────────┼───────────────────┼──────────────────────────────────┤                                                              
  │ 최종 게이트 │ CI/CD             │ PR 머지 전 전체 테스트 통과 강제 │                                                              
  └─────────────┴───────────────────┴──────────────────────────────────┘                                                              
  가장 효과적인 방법은 1번(Hooks) + 2번(CLAUDE.md) 조합입니다. 에이전트가 코드를 쓸 때마다 자동으로 검증이 돌고, 실패하면 에이전트가  
  에러 메시지를 보고 스스로 고치는 루프가 만들어집니다.                                                                               
                                                            


⏺ OpenClaw 프로젝트에 AI 에이전트 자기검증 루프가 매우 체계적으로 구축되어 있습니다. 정리하면:                                        
                                                                                                                                      
  ---                                                                                                                                 
  OpenClaw의 에이전트 자기검증 시스템 (다층 구조)                                                                                     
                                                                                                                                      
  1층: CLAUDE.md (= AGENTS.md) — 에이전트 행동 규칙                                                                                   
                                                                                                                                      
  - CLAUDE.md → AGENTS.md로 심볼릭 링크                                                                                               
  - 빌드/린트/테스트 명령어, 커밋 워크플로우, 멀티 에이전트 안전 수칙 등 179줄짜리 지침서                                             
  - 최종 게이트: pnpm lint && pnpm build && pnpm test 통과 후에만 커밋 허용                                                           
                                                                                                                                      
  2층: Pre-commit Hook — 자동 포맷/린트                                                                                               
                                                                                                                                      
  - .pre-commit-config.yaml + git-hooks/pre-commit                                                                                    
  - 커밋 시 자동으로: trailing whitespace 제거, oxlint, oxfmt, shellcheck, 시크릿 감지 실행                                           
  - scripts/format-staged.js가 스테이징된 파일 자동 포맷 후 재스테이징                                                                
                                                                                                                                      
  3층: .pi/ 디렉토리 — 에이전트 전용 프롬프트                                                                                         
  ┌───────┬──────────────────────────────┐                                                                                            
  │ 파일  │             역할             │                                                                                            
  ├───────┼──────────────────────────────┤                                                                                            
  │ cl.md │ 체인지로그 감사              │                                                                                            
  ├───────┼──────────────────────────────┤                                                                                            
  │ pr.md │ PR 리뷰 (Good/Bad/Ugly 구조) │                                                                                            
  ├───────┼──────────────────────────────┤                                                                                            
  │ is.md │ 이슈 분석 및 근본 원인 추적  │                                                                                            
  └───────┴──────────────────────────────┘                                                                                            
  4층: .agent/workflows/ — 에이전트 워크플로우                                                                                        
                                                                                                                                      
  - update_clawdbot.md에 단계별 검증 루프 4개 정의                                                                                    
  - 각 단계마다 pnpm build → pnpm test → health check 반복                                                                            
                                                                                                                                      
  5층: GitHub Actions CI/CD — 최종 자동 검증                                                                                          
                                                                                                                                      
  - 14개 이상의 검증 단계 병렬 실행                                                                                                   
  - TypeScript 체크, oxlint, vitest, 프로토콜 스키마 검증, 포맷 체크                                                                  
  - Windows/macOS/Android 크로스 플랫폼 테스트                                                                                        
                                                                                                                                      
  6층: package.json 스크립트                                                                                                          
                                                                                                                                      
  pnpm lint          → oxlint --type-aware                                                                                            
  pnpm build         → TypeScript 컴파일                                                                                              
  pnpm test          → vitest                                                                                                         
  pnpm test:all      → lint && build && test && e2e && live && docker                                                                 
  pnpm test:coverage → 커버리지 70% 임계값                                                                                            
                                                                                                                                      
  ---                                                                                                                                 
  핵심 구조 요약                                                                                                                      
                                                                                                                                      
  에이전트 코드 작성                                                                                                                  
    ↓                                                                                                                                 
  pre-commit hook (포맷 + 린트 자동 실행)                                                                                             
    ↓ 실패 시 커밋 차단 → 에이전트가 수정 후 재시도                                                                                   
  로컬 게이트 (pnpm lint && build && test)                                                                                            
    ↓ 실패 시 → 에이전트가 에러 보고 수정 후 재시도                                                                                   
  PR 생성                                                                                                                             
    ↓                                                                                                                                 
  GitHub Actions CI (14+ 검증 단계)                                                                                                   
    ↓ 실패 시 → 에이전트가 다시 수정                                                                                                  
  머지                                                                                                                                
                                                                                                                                      
  이 구조를 현재 프로젝트에 적용해볼까요?  


     현재 상태                                                                                                                        
                                                                                                                                      
     - Next.js 16 + TypeScript + pnpm                                                                                                 
     - ESLint 9 + Prettier 3 설정 있음                                                                                                
     - Playwright E2E 테스트 있음                                                                                                     
     - 없는 것: CLAUDE.md, .claude/ hooks, pre-commit hooks, CI/CD, 유닛 테스트                                                       
                                                                                                                                      
     적용할 것                                                                                                                        
                                                                                                                                      
     1. CLAUDE.md 생성 (에이전트 행동 규칙)                                                                                           
                                                                                                                                      
     - 경로: /Users/ojeong-il/XXX-VIBE/dog-love/frontend/CLAUDE.md                                                                    
     - 빌드/린트/테스트 명령어 정리                                                                                                   
     - 코드 수정 후 검증 절차 명시                                                                                                    
     - 커밋 워크플로우 (검증 통과 후에만 커밋)                                                                                        
     - .cursorrules 내용과 일관성 유지                                                                                                
                                                                                                                                      
     2. package.json 스크립트 추가                                                                                                    
                                                                                                                                      
     - format:check — prettier --check                                                                                                
     - format:fix — prettier --write                                                                                                  
     - typecheck — tsc --noEmit (타입 체크만)                                                                                         
     - validate — lint && typecheck && build (로컬 게이트)                                                                            
                                                                                                                                      
     3. .claude/settings.json 생성 (Claude Code Hooks)                                                                                
                                                                                                                                      
     - 경로: /Users/ojeong-il/XXX-VIBE/dog-love/frontend/.claude/settings.json                                                        
     - 파일 수정 후 자동으로 lint + typecheck 실행                                                                                    
     - 실패 시 에이전트가 피드백 받아 자동 수정                                                                                       
                                                                                                                                      
     4. Pre-commit Hook 설정                                                                                                          
                                                                                                                                      
     - lint-staged + husky 설치                                                                                                       
     - 커밋 시 자동으로: prettier format + eslint fix                                                                                 
     - 경로: .husky/pre-commit                                                                                                        
                                                                                                                                      
     5. GitHub Actions CI 워크플로우                                                                                                  
                                                                                                                                      
     - 경로: .github/workflows/ci.yml                                                                                                 
     - PR 시 자동 실행: lint → typecheck → build → test:e2e                                                                           
     - 병렬 실행으로 빠른 피드백                                                                                                      
                                                                                                                                      
     수정/생성 파일 목록                                                                                                              
                                                                                                                                      
     1. CLAUDE.md — 새로 생성                                                                                                         
     2. package.json — 스크립트 추가 + husky/lint-staged devDependencies                                                              
     3. .claude/settings.json — 새로 생성                                                                                             
     4. .husky/pre-commit — 새로 생성                                                                                                 
     5. .lintstagedrc.json — 새로 생성                                                                                                
     6. .github/workflows/ci.yml — 새로 생성                                                                                          
                                                                                                                                      
     검증                                                                                                                             
                                                                                                                                      
     - pnpm lint 통과 확인                                                                                                            
     - pnpm typecheck 통과 확인                                                                                                       
     - pnpm build 통과 확인                                                                                                           
     - pre-commit hook 동작 테스트 (임의 파일 수정 → 커밋 시도)                                                                       
                                                                                                                                      
⏺ 구현을 시작하겠습니다. 먼저 package.json을 읽고, 파일들을 생성하겠습니다.                       



 적용 완료 — 요약                                                                                                                    
                                                                                                                                      
  생성/수정된 파일 6개                                                                                                                
  ┌──────────────────────────┬───────────────────────────────────────────────────────────────────────────────────────┐                
  │           파일           │                                         역할                                          │                
  ├──────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤                
  │ CLAUDE.md                │ 에이전트 행동 규칙 (검증 절차, 커밋 규칙, 코딩 컨벤션)                                │                
  ├──────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤                
  │ package.json             │ typecheck, format:check/fix, validate, prepare 스크립트 추가 + husky/lint-staged 설치 │                
  ├──────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤                
  │ .lintstagedrc.json       │ 커밋 시 자동 eslint fix + prettier format                                             │                
  ├──────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤                
  │ .husky/pre-commit        │ git 커밋 시 lint-staged 자동 실행 (git root에 설정)                                   │                
  ├──────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤                
  │ .claude/settings.json    │ Claude Code hooks — 파일 수정 시 자동 lint + typecheck                                │                
  ├──────────────────────────┼───────────────────────────────────────────────────────────────────────────────────────┤                
  │ .github/workflows/ci.yml │ PR/push 시 lint → typecheck → build → e2e 자동 검증                                   │                
  └──────────────────────────┴───────────────────────────────────────────────────────────────────────────────────────┘                
  검증 루프 구조                                                                                                                      
                                                                                                                                      
  에이전트 코드 수정                                                                                                                  
    ↓                                                                                                                                 
  Claude Code Hook (자동 lint + typecheck) ← 즉시 피드백                                                                              
    ↓ 실패 → 에이전트가 수정 후 재시도                                                                                                
  git commit 시도                                                                                                                     
    ↓                                                                                                                                 
  pre-commit hook (lint-staged: eslint fix + prettier) ← 자동 교정                                                                    
    ↓ 실패 → 커밋 차단, 에이전트가 수정                                                                                               
  PR 생성                                                                                                                             
    ↓                                                                                                                                 
  GitHub Actions (lint → typecheck → build → e2e) ← 최종 게이트                                                                       
    ↓ 실패 → 에이전트가 수정 후 재푸시                                                                                                
  머지 ✅                                


⏺ OpenClaw에는 있지만 dog-love/frontend에는 아직 없는 것들을 정리하면:                                                                                  
                                                                                                                                                        
  OpenClaw vs dog-love/frontend 비교                                                                                                                    
  ┌────────────────────────┬──────────────────────────────────────────────────────────────────────────┬─────────────────────────────────────────┐       
  │          항목          │                                 OpenClaw                                 │            dog-love/frontend            │       
  ├────────────────────────┼──────────────────────────────────────────────────────────────────────────┼─────────────────────────────────────────┤       
  │ 에이전트 지침서        │ AGENTS.md 179줄 (멀티에이전트 안전수칙 포함)                             │ CLAUDE.md 60줄 (기본 검증 절차)         │       
  ├────────────────────────┼──────────────────────────────────────────────────────────────────────────┼─────────────────────────────────────────┤       
  │ Pre-commit             │ .pre-commit-config.yaml (oxlint, oxfmt, shellcheck, 시크릿 감지 등 다층) │ husky + lint-staged (eslint + prettier) │       
  ├────────────────────────┼──────────────────────────────────────────────────────────────────────────┼─────────────────────────────────────────┤       
  │ 시크릿 감지            │ detect-secrets + .secrets.baseline                                       │ 없음                                    │       
  ├────────────────────────┼──────────────────────────────────────────────────────────────────────────┼─────────────────────────────────────────┤       
  │ 에이전트 전용 프롬프트 │ .pi/ 디렉토리 (PR 리뷰, 이슈 분석, 체인지로그 감사)                      │ 없음                                    │       
  ├────────────────────────┼──────────────────────────────────────────────────────────────────────────┼─────────────────────────────────────────┤       
  │ 에이전트 워크플로우    │ .agent/workflows/ (단계별 검증 루프 정의)                                │ 없음                                    │       
  ├────────────────────────┼──────────────────────────────────────────────────────────────────────────┼─────────────────────────────────────────┤       
  │ CI/CD                  │ 14+ 병렬 검증 (크로스플랫폼, 프로토콜 스키마, Docker E2E 등)             │ 4단계 (lint → typecheck → build → e2e)  │       
  ├────────────────────────┼──────────────────────────────────────────────────────────────────────────┼─────────────────────────────────────────┤       
  │ 유닛 테스트            │ vitest + 커버리지 70% 임계값                                             │ 없음 (E2E만 존재)                       │       
  ├────────────────────────┼──────────────────────────────────────────────────────────────────────────┼─────────────────────────────────────────┤       
  │ 포맷터                 │ oxfmt (Rust 기반, 초고속)                                                │ Prettier                                │       
  ├────────────────────────┼──────────────────────────────────────────────────────────────────────────┼─────────────────────────────────────────┤       
  │ 린터                   │ oxlint --type-aware                                                      │ ESLint 9                                │       
  ├────────────────────────┼──────────────────────────────────────────────────────────────────────────┼─────────────────────────────────────────┤       
  │ 멀티에이전트 안전수칙  │ git stash/worktree/브랜치 충돌 방지 프로토콜                             │ 없음                                    │       
  ├────────────────────────┼──────────────────────────────────────────────────────────────────────────┼─────────────────────────────────────────┤       
  │ 체인지로그 관리        │ 자동 감사 프롬프트 (cl.md)                                               │ 없음                                    │       
  ├────────────────────────┼──────────────────────────────────────────────────────────────────────────┼─────────────────────────────────────────┤       
  │ 커밋 스크립트          │ scripts/committer (스코프별 스테이징)                                    │ 일반 git commit                         │       
  ├────────────────────────┼──────────────────────────────────────────────────────────────────────────┼─────────────────────────────────────────┤       
  │ AI PR 정책             │ CONTRIBUTING.md에 AI PR 환영 + 투명성 요구                               │ 없음                                    │       
  └────────────────────────┴──────────────────────────────────────────────────────────────────────────┴─────────────────────────────────────────┘       
  핵심 차이 3가지                                                                                                                                       
                                                                                                                                                        
  1. 멀티에이전트 지원 — 없음                                                                                                                           
                                                                                                                                                        
  OpenClaw는 5~10개 에이전트가 동시에 작업할 때 브랜치 충돌, git stash 오염, 상태 교차 방지 프로토콜이 있음. dog-love/frontend는 단일 에이전트          
  기준으로만 설정됨.                                                                                                                                    
                                                                                                                                                        
  2. 에이전트 전용 프롬프트 시스템 — 없음                                                                                                               
                                                                                                                                                        
  OpenClaw의 .pi/ 디렉토리는 에이전트에게 역할별 전문 지시를 줌:                                                                                        
  - pr.md — PR 리뷰 시 Good/Bad/Ugly 구조로 분석                                                                                                        
  - is.md — 이슈의 근본 원인 추적 (사용자 제공 원인 무시)                                                                                               
  - cl.md — 체인지로그 누락 감사                                                                                                                        
                                                                                                                                                        
  3. 유닛 테스트 + 커버리지 게이트 — 없음                                                                                                               
                                                                                                                                                        
  OpenClaw는 vitest로 유닛/통합 테스트 + 커버리지 70% 미달 시 실패 처리. dog-love/frontend는 Playwright E2E만 있어서 에이전트가 빠르게 검증할 수 있는   
  경량 테스트 루프가 부족함.                                                                                                                            
                                                                                                                                                        
  ---                                                                                                                                                   
  추가로 적용하고 싶은 부분이 있으면 말씀해주세요. 특히 유닛 테스트(vitest) 도입과 에이전트 전용 프롬프트(.pi/) 가 효과가 클 것 같습니다.     



특히 유닛 테스트(vitest) 도입과 에이전트 전용 프롬프트(.pi/) 적용해줘 

적용 완료 요약                                                                                                                                        
                                                                                                                                                        
  vitest 유닛 테스트                                                                                                                                    
  ┌───────────────────┬─────────────────────────────────────────────────────────────────────┐                                                           
  │       파일        │                                역할                                 │                                                           
  ├───────────────────┼─────────────────────────────────────────────────────────────────────┤                                                           
  │ vitest.config.ts  │ vitest 설정 (jsdom, path alias, 커버리지 70% 임계값)                │                                                           
  ├───────────────────┼─────────────────────────────────────────────────────────────────────┤                                                           
  │ vitest.setup.ts   │ jest-dom matchers 연동                                              │                                                           
  ├───────────────────┼─────────────────────────────────────────────────────────────────────┤                                                           
  │ lib/utils.test.ts │ cn() 유틸리티 테스트 예제 (5개 통과)                                │                                                           
  ├───────────────────┼─────────────────────────────────────────────────────────────────────┤                                                           
  │ package.json      │ test, test:watch, test:coverage 스크립트 추가, validate에 test 포함 │                                                           
  └───────────────────┴─────────────────────────────────────────────────────────────────────┘                                                           
  에이전트 전용 프롬프트 (.pi/)                                                                                                                         
  ┌─────────────────────┬──────────────────────────────────────────────────────┐                                                                        
  │        파일         │                         역할                         │                                                                        
  ├─────────────────────┼──────────────────────────────────────────────────────┤                                                                        
  │ .pi/prompts/pr.md   │ PR 리뷰 — Good/Bad/Ugly 구조, 보안/성능 체크리스트   │                                                                        
  ├─────────────────────┼──────────────────────────────────────────────────────┤                                                                        
  │ .pi/prompts/is.md   │ 이슈 분석 — 버그 근본 원인 추적, 기능 요청 구현 제안 │                                                                        
  ├─────────────────────┼──────────────────────────────────────────────────────┤                                                                        
  │ .pi/prompts/test.md │ 테스트 작성 가이드 — vitest + testing-library 패턴   │                                                                        
  └─────────────────────┴──────────────────────────────────────────────────────┘                                                                        
  업데이트된 검증 루프                                                                                                                                  
                                                                                                                                                        
  pnpm validate = lint → typecheck → test → build                                                                                                       
                                                                                                                                                        
  이제 에이전트가 코드 수정 시 유닛 테스트도 자동 검증하고, .pi/ 프롬프트로 PR 리뷰/이슈 분석도 구조화된 방식으로 수행할 수 있습니다.   


   추가 적용 가능한 것들                                                                                                                                 
                                                                                                                                                        
  1. 시크릿 감지 (보안)                                                                                                                                 
                                                                                                                                                        
  - detect-secrets로 커밋 시 API 키, 토큰, 비밀번호 등 실수로 커밋하는 것 방지                                                                          
  - pre-commit hook에 추가                                                                                                                              
                                                                                                                                                        
  2. 멀티에이전트 안전수칙 (CLAUDE.md 보강)                                                                                                             
                                                                                                                                                        
  - 여러 에이전트 동시 작업 시 git stash/브랜치 충돌 방지 프로토콜                                                                                      
  - 지금은 단일 에이전트 기준으로만 되어 있음                                                                                                           
                                                                                                                                                        
  3. 에이전트 워크플로우 (.agent/workflows/)                                                                                                            
                                                                                                                                                        
  - 배포 전 체크리스트, 리팩토링 절차 등 단계별 검증 루프 문서화                                                                                        
  - OpenClaw의 update_clawdbot.md처럼 복잡한 작업의 절차를 정의                                                                                         
                                                                                                                                                        
  4. 커밋 스크립트 (scripts/committer)                                                                                                                  
                                                                                                                                                        
  - 스코프별 스테이징 + 자동 conventional commit 메시지 생성                                                                                            
  - 에이전트가 관련 파일만 정확히 커밋하도록 강제                                                                                                       
                                                                                                                                                        
  5. CONTRIBUTING.md (AI PR 정책)                                                                                                                       
                                                                                                                                                        
  - AI로 생성한 PR 표시 규칙, 테스트 수준 명시 요구                                                                                                     
  - 팀 협업 시 투명성 확보                                                                                                                              
                                                                                                                                                        
  6. 컴포넌트 테스트 확대                                                                                                                               
                                                                                                                                                        
  - 현재 cn() 하나만 테스트 중                                                                                                                          
  - 주요 훅(hooks/)과 유틸(lib/) 전체에 테스트 추가                                                                                                     
                                                                                                                                                        
  7. GitHub PR 자동 라벨링                                                                                                                              
                                                                                                                                                        
  - labeler.yml로 변경 파일 경로에 따라 자동 라벨 (frontend, api, test 등)                                                                              
                                                                                                                                                        
  8. 번들 사이즈 체크                                                                                                                                   
                                                                                                                                                        
  - @next/bundle-analyzer가 이미 설치되어 있으니 CI에서 번들 사이즈 리포트 자동 생성                                                                    
                                                                                                                                                        
  ---                                                                                                                                                   
  우선순위로 보면 시크릿 감지와 컴포넌트 테스트 확대가 실질적 효과가 가장 큽니다. 어떤 것부터 적용할까요?     


3. 에이전트 워크플로우 (.agent/workflows/)   적용해줘


⏺ 적용 완료. 생성된 파일 4개:                                                                                                                           
  ┌────────────────┬─────────────────────────────────────────────────────┬─────────────────────────────────┐                                            
  │   워크플로우   │                        단계                         │            검증 루프            │                                            
  ├────────────────┼─────────────────────────────────────────────────────┼─────────────────────────────────┤                                            
  │ deploy.md      │ 사전 검증 → 환경별 빌드 → 결과 검증 → 배포          │ 각 단계마다 실패 시 이전 단계로 │                                            
  ├────────────────┼─────────────────────────────────────────────────────┼─────────────────────────────────┤                                            
  │ new-feature.md │ 설계 → 타입 → API → 컴포넌트 → 테스트 → 검증 → 커밋 │ 7단계, 각 단계 typecheck/test   │                                            
  ├────────────────┼─────────────────────────────────────────────────────┼─────────────────────────────────┤                                            
  │ bug-fix.md     │ 재현 → 원인 분석 → 최소 수정 → 회귀 테스트 → 검증   │ .pi/prompts/is.md 연동          │                                            
  ├────────────────┼─────────────────────────────────────────────────────┼─────────────────────────────────┤                                            
  │ refactor.md    │ 범위 정의 → 기존 테스트 확인 → 단계별 수정 → 검증   │ 테스트 없으면 먼저 작성 강제    │                                            
  └────────────────┴─────────────────────────────────────────────────────┴─────────────────────────────────┘                                            
  CLAUDE.md에도 워크플로우 참조 섹션이 추가되었습니다. 이제 에이전트에게 "새 기능 만들어줘", "이 버그 수정해줘", "배포해줘" 같은 요청을 하면 해당       
  워크플로우를 따라 단계별로 검증하면서 진행합니다.                    

  ❯ 4. 커밋 스크립트 (scripts/committer) 설명 ?                                                                                                           
                                                                                                                                                        
⏺ 커밋 스크립트 (scripts/committer)                                                                                                                     
                                                                                                                                                        
  문제 상황                                                                                                                                             
                                                                                                                                                        
  에이전트가 커밋할 때 흔히 발생하는 실수:                                                                                                              
                                                                                                                                                        
  # 위험: 관계없는 파일까지 전부 커밋                                                                                                                   
  git add -A                                                                                                                                            
  git commit -m "feat: add login page"                                                                                                                  
  # → 다른 에이전트의 작업, 임시 파일, .env 변경까지 포함됨                                                                                             
                                                                                                                                                        
  # 위험: 실수로 관련 파일 누락                                                                                                                         
  git add app/login/page.tsx                                                                                                                            
  git commit -m "feat: add login page"                                                                                                                  
  # → lib/auth.ts, hooks/use-auth.ts 등 관련 파일 누락                                                                                                  
                                                                                                                                                        
  OpenClaw의 scripts/committer 동작                                                                                                                     
                                                                                                                                                        
  # 사용법                                                                                                                                              
  scripts/committer "feat: add login page" app/login/page.tsx lib/auth.ts hooks/use-auth.ts                                                             
                                                                                                                                                        
  # 내부 동작:                                                                                                                                          
  # 1. 지정된 파일만 정확히 스테이징                                                                                                                    
  # 2. 나머지 파일은 건드리지 않음                                                                                                                      
  # 3. conventional commit 형식 검증                                                                                                                    
  # 4. 커밋 실행                                                                                                                                        
                                                                                                                                                        
  일반 git commit과의 차이                                                                                                                              
  ┌──────────────┬──────────────────────────────────┬───────────────────────────────┐                                                                   
  │              │         git add + commit         │       scripts/committer       │                                                                   
  ├──────────────┼──────────────────────────────────┼───────────────────────────────┤                                                                   
  │ 스테이징     │ 수동, 실수 가능                  │ 인자로 명시, 정확함           │                                                                   
  ├──────────────┼──────────────────────────────────┼───────────────────────────────┤                                                                   
  │ 범위         │ -A로 전체 또는 수동 선택         │ 지정 파일만                   │                                                                   
  ├──────────────┼──────────────────────────────────┼───────────────────────────────┤                                                                   
  │ 메시지 검증  │ 없음                             │ conventional commit 형식 강제 │                                                                   
  ├──────────────┼──────────────────────────────────┼───────────────────────────────┤                                                                   
  │ 멀티에이전트 │ 다른 에이전트 파일 포함 위험     │ 자기 파일만 커밋              │                                                                   
  ├──────────────┼──────────────────────────────────┼───────────────────────────────┤                                                                   
  │ 한 줄 실행   │ git add ... && git commit -m ... │ committer "msg" files...      │                                                                   
  └──────────────┴──────────────────────────────────┴───────────────────────────────┘                                                                   
  이 프로젝트에 적용하면                                                                                                                                
                                                                                                                                                        
  # Before                                                                                                                                              
  git add app/login/page.tsx lib/auth.ts hooks/use-auth.ts                                                                                              
  git commit -m "feat: add login page"                                                                                                                  
                                                                                                                                                        
  # After                                                                                                                                               
  ./scripts/committer "feat: add login page" \                                                                                                          
    app/login/page.tsx \                                                                                                                                
    lib/auth.ts \                                                                                                                                       
    hooks/use-auth.ts                                                                                                                                   
                                                                                                                                                        
  스크립트 내부에서:                                                                                                                                    
  1. 파일 존재 여부 확인                                                                                                                                
  2. feat:, fix: 등 conventional commit 접두사 검증                                                                                                     
  3. 지정 파일만 git add                                                                                                                                
  4. pnpm validate 실행 (선택적)                                                                                                                        
  5. 통과 시 커밋, 실패 시 스테이징 해제 후 중단                                                                                                        
                                                                                                                                                        
  특히 유용한 상황                                                                                                                                      
                                                                                                                                                        
  에이전트 A: 로그인 기능 개발 중 (5개 파일 수정)                                                                                                       
  에이전트 B: 대시보드 개발 중 (3개 파일 수정)                                                                                                          
                                                                                                                                                        
  git status:                                                                                                                                           
    modified: app/login/page.tsx        ← A의 작업                                                                                                      
    modified: lib/auth.ts               ← A의 작업                                                                                                      
    modified: hooks/use-auth.ts         ← A의 작업                                                                                                      
    modified: app/dashboard/page.tsx    ← B의 작업                                                                                                      
    modified: components/chart.tsx      ← B의 작업                                                                                                      
                                                                                                                                                        
  # committer 없이:                                                                                                                                     
  git add -A  → A가 B의 파일까지 커밋 💥                                                                                                                
                                                                                                                                                        
  # committer 사용:                                                                                                                                     
  ./scripts/committer "feat: add login" app/login/page.tsx lib/auth.ts hooks/use-auth.ts                                                                
  → A의 파일만 정확히 커밋 ✓                                                                                                                            
                                                                                                                                                        
  적용할까요?                      

  ⏺ 두 가지 검증 모두 정상 동작합니다.                                                                                                                    
                                                                                                                                                        
  적용 완료.                                                                                                                                            
  ┌────────────────────┬──────────────────────────────────────────────────┐                                                                             
  │        검증        │                       결과                       │                                                                             
  ├────────────────────┼──────────────────────────────────────────────────┤                                                                             
  │ 잘못된 커밋 메시지 │ 차단 + 형식 안내                                 │                                                                             
  ├────────────────────┼──────────────────────────────────────────────────┤                                                                             
  │ 존재하지 않는 파일 │ 차단 + 파일 목록 표시                            │                                                                             
  ├────────────────────┼──────────────────────────────────────────────────┤                                                                             
  │ 정상 커밋          │ lint → typecheck → test 검증 후 통과 시에만 커밋 │                                                                             
  ├────────────────────┼──────────────────────────────────────────────────┤                                                                             
  │ 검증 실패 시       │ 스테이징 자동 해제 (원상복구)                    │                                                                             
  └────────────────────┴──────────────────────────────────────────────────┘                                                                             
  scripts/committer.sh가 생성되었고, CLAUDE.md에도 사용법이 추가되었습니다. 에이전트가 커밋할 때 git add -A 대신 이 스크립트를 사용하면 자기 파일만     
  정확히 커밋합니다.            

  