# 리팩토링 워크플로우

## Step 1: 범위 정의

- 리팩토링 대상 파일/모듈 식별
- 리팩토링 목표 명확화 (성능? 가독성? 구조 개선?)
- 영향받는 파일 전체 목록 작성

검증:

- 범위가 명확한가?
- 범위가 너무 넓으면 → 단계별로 나눠서 진행

## Step 2: 기존 테스트 확인

```bash
pnpm test
```

- 리팩토링 대상에 기존 테스트가 있는지 확인
- 없으면 → **리팩토링 전에 현재 동작을 보장하는 테스트를 먼저 작성**

검증:

- 대상 코드의 테스트 커버리지가 충분한가?
- 부족하면 → 테스트 추가 후 다음 단계로

## Step 3: 리팩토링 실행

- 한 번에 하나의 변경만 적용
- 동작 변경 없이 구조만 개선 (behavior-preserving)
- 각 변경 후 즉시 검증:

```bash
pnpm typecheck && pnpm test
```

- 실패 시 → 해당 변경 되돌리고 다른 접근법 시도

## Step 4: 전체 검증

```bash
pnpm validate
```

- 모든 기존 테스트가 통과하는지 확인
- 빌드가 성공하는지 확인
- 실패 시 → Step 3에서 문제된 변경 찾아 수정

## Step 5: 커밋

- conventional commit: `refactor: 변경 설명`
- 동작 변경이 섞여있으면 → 리팩토링과 기능 변경을 별도 커밋으로 분리
